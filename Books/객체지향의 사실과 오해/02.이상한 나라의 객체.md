## 객체, 그리고 소프트웨어 나라

- 객체를 상태(state), 행동(behavior), 식별자(identity)를 지닌 실체로 보는 것이 가장 효과적이다.

- 객체란?
  - 식별 가능한 개체 또는 사물이다. 객체는 자동차처럼 만질 수 있는 구체적인 사물일 수도 있고, 시간처럼 추상적인 개념일 수도 있다.
  - 객체는 구별 가능한 식별자, 특징적인 행동, 변경 가능한 상태를 가진다.
  - 소프트웨어 안에서 객체는 저장된 상태와 실행 가능한 코드를 통해 구현된다.

### 상태

#### 왜 상태가 필요한가

- 어떤 행동의 결과는 과거에 어떤 행동들이 일어났었느냐에 의존한다.
- 상태를 이용하면 과거에 얽매이지 않고 현재를 기반으로 객체의 행동 방식을 이해할 수 있다.

#### 상태와 프로퍼티

- 객체의 상태를 구성하는 모든 특징을 통틀어 객체의 **프로퍼티(property)**라고 한다.
  - 일반적으로 프로퍼티는 변경되지 않고 고정되기 때문에 '정적'이다.
  - 반면 **프로퍼티 값(property values)**은 시간이 프름에 따라 변경되기 때문에 '동적'이다.
- 객체와 객체 사이의 의미 있는 연결을 **링크(link)**라고 한다.
- 객체를 구성하는 단순한 값을 **속성(attribute)**이라고 한다.
  - 앨리스의 키와 위치는 단순한 값으로 표현되기 때문에 속성이다.
- 객체의 프로퍼티는 단순한 값인 속성과 다른 객체를 가리키는 링크라는 두 가지 종류의 조합으로 표현할 수 있다.

> 보통 프로퍼티, 속성, 멤버 변수를 공통의 의미로 의사소통하는 경우가 있다.

- 상태란?
  - 상태는 특정 시점에 객체가 가지고 있는 정보의 집합으로 객체의 구조적 특징을 표현한다.
  - 객체의 상태는 객체에 존재하는 정적인 프로퍼티와 동적인 프로퍼티 값으로 구성된다.
  - 객체의 프로퍼티는 단순한 값과 다른 객체를 참조하는 링크로 구분할 수 있다.

### 행동

#### 상태와 행동

- 상태와 행동 사이의 관계
  - 객체의 행동은 상태에 영향을 받는다.
  - 객체의 행동은 상태를 변경시킨다.
- 상태라는 개념을 이용해 해동을 두가지 관점에서 서술할 수 있음을 의미한다.
  - 상호작용이 현재의 상태에 어떤 방슥으로 의존하는가
  - 상호작용이 어떻게 현재의 상태를 변경시키는가

#### 협력과 행동

- 행동이란?
  - 외부의 요청 또는 수니된 메시지에 응답하기 위해 동작하고 반응하는 활동이다.
  - 행동의 결과로 객체는 자신의 상태를 변경하거나 다른 객체에게 메시지를 전달할 수 있다.
  - 객체는 행동을 통해 다른 객체와의 협력헤 참여하므로 행동은 외부에 가시적이어야 한다.

#### 상태 캡슐화

- 객체는 상태를 캡슐 안에 감춰둔 채 외부로 노출하지 않는다.
- 객체가 외부에 노출하는 것은 행동뿐이며, 외부에서 객체에 접근할 수 있는 유일한 방법 역시 행동뿐이다.
  - 따라서 앨리스는 직접적으로 음료의 상태를 변경할 수 없다.
  - 단지 음료에게 자신이 음료를 마셨다는 메시지를 전달할 수 있을 뿐이다.
- 상태를 잘 정의된 행동 집합 뒤로 캡슐화하는 것은 객체의 자율성을 높이고 협력을 단순하고 유연하게 만든다.
  - 이것이 상태를 캡슐화해야 하는 이유다.

### 식별자

- 식별 가능하다는 것은 객체를 서로 구별할 수 있는 특정한 프로퍼티가 객체안에 존재하는 것을 의미한다.
  - 이 프로퍼티를 **식별자**라고 한다.

> 식별자는 클라이언트 코드로 따지면, DB로 부터 받은 id가 될 수 있다.

- 값(value)은 숫자, 문자열, 날짜, 시간, 금액 등과 같이 변하지 않는 양을 모델링한다.
  - 흔히 값의 상태는 변하지 않기 때문에 **불변 상태(immutable state)**를 가진다고 말한다.
- 값이 같은지 여부는 상태가 같은지를 이용해 판단한다.
  - 값의 상태가 같으면 두 인스턴스는 동일한 것으로 판단하고 상태가 다르면 두 인스턴스는 다른 것으로 판단한다.
  - 이 처럼 상태를 이용해 두값이 같은지 판단할 수 있는 성질을 **동등성(equality)**이라고 한다.

> 데이터 클래스가 값 객체 중에 하나이다.

- 객체는 시간에 따라 변경되는 상태를 포함하며, 행동을 통해 상태를 변경한다.
  - 이를 객체는 **가변 상태(mutable state)**를 가진다 말한다.
- 객체 역시 사람과 유사하게 상태와 무관하게 두 객체를 동일하거나 다르다고 판단할 수 있는 프로퍼티를 가진다.
  - 두 객체의 상태가 다르더라도 식별자가 같다면 두 객체를 같은 객체로 판단할 수 있다.
  - 이처럼 식별자를 기반으로 객체가 같은지를 판단할 수 있는 성질을 **동일성(identical)**이라고 한다.
- 식별자란?
  - 어떤 객체를 다른 객체와 구분하는 데 사용하는 객체의 프로퍼티다.
  - 값은 식별자를 가지지 않기 때문에 상태를 이용한 동등성 검사를 통해 두 인스턴스를 비교해야 한다.
  - 객체는 상태가 변경될 수 있기 때문에 식별자를 이용한 동일성 검사를 통해 두 인스턴스를 비교할 수 있다.
- 용어 정리
  - 식별자를 지닌 전통적인 의미의 객체: **참조 개체(reference object)**, **엔티티(entity)**.
  - 식별자를 가지지 않는 값: **값 객체(value object)**.

## 기계로서의 객체

- **쿼리(query)**: 객체의 상태를 조회하는 작업.
- **명령(command)**: 객체의 상태를 변경하는 작업.

## 행동이 상태를 결정한다.

- 상태를 먼저 결정하고 행동을 나중에 결정하는 방법은 설계에 나쁜 영향을 끼친다.
  1. 상태를 먼저 결정할 경우 캡슐화가 저해된다.
  2. 객체를 협력자가 아닌 고립된 섬으로 만든다.
  3. 객체의 재사용성이 저하된다.
- 협력 안에서 객체의 행동은 결국 객체가 협력에 참여하면서 완수해야 하는 책임을 의미.
- 따라서 어떤 책임이 필요한가를 결정하는 과정이 전체 설계를 주도해야 한다.
  - **책임-주도 설계(Responsibility-Driven Design, RDD)**
